# all the codes for training pipeline